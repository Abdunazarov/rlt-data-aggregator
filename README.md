# Бот: Data Aggregator

Data Aggregator (`@JSON_aggregator_bot`) — это бот для Telegram, предназначенный для агрегации статистических данных за указанные временные интервалы. Это идеальный инструмент для быстрого анализа тенденций и суммирования данных, особенно фокусируясь на финансовых или числовых данных, которые меняются со временем.

## Структура проекта

Структура директорий проекта представлена следующим образом:

```
.
├── bot.py              # Основной файл бота; обрабатывает взаимодействие с Telegram
├── db_connector.py     # Управляет подключениями и запросами к MongoDB
├── .env                # Содержит переменные окружения (не отслеживается Git)
├── .env.example        # Пример необходимых переменных окружения
├── .gitignore          # Указывает файлы, которые намеренно не отслеживаются
├── initialize_db.py    # Скрипт для инициализации базы данных примерами данных
├── requirements.txt    # Список всех зависимостей Python
└── settings.py         # Централизованный файл конфигурации для проекта
```

## Обзор реализации

Бот структурирован вокруг нескольких ключевых компонентов:

- **API Telegram Bot:** Использует библиотеку python-telegram-bot для взаимодействия с пользователями через Telegram.
- **База данных MongoDB:** Хранит и агрегирует данные. `db_connector.py` управляет подключением и запросами к данным.
- **Переменные окружения:** Конфигурация, такая как токен бота и URI базы данных, хранятся в `.env` для безопасности.
- **Инициализация данных:** `initialize_db.py` может заполнить базу данных тестовыми данными для целей тестирования.

## Как это работает

1. **Взаимодействие с пользователем:** Пользователи отправляют боту JSON с критериями агрегации (диапазон дат и тип агрегации).
2. **Агрегация данных:** Бот, через `db_connector.py`, делает запросы к базе данных MongoDB в соответствии с запросом пользователя.
3. **Ответ:** Бот агрегирует данные соответствующим образом и отправляет пользователю суммированный результат.

## Установка и запуск

1. **Клонируйте репозиторий:**

   ```
   git clonehttps://github.com/Abdunazarov/rlt-data-aggregator.git
   cd rlt-data-aggregator
   ```

2. **Установите зависимости:**

   ```
   pip install -r requirements.txt
   ```

3. **Настройте переменные окружения:**

   Скопируйте `.env.example` в `.env` и заполните необходимые данные, такие как ваш MongoDB URI и токен Telegram Bot.

   ```
   cp .env.example .env
   ```

4. **Инициализируйте базу данных (по желанию):**

   Если вы хотите заполнить вашу базу данных тестовыми данными:

   ```
   python initialize_db.py
   ```

5. **Запустите бота:**

   ```
   python bot.py
   ```

## Использование бота

Для взаимодействия с ботом отправьте сообщение в следующем формате:

```
{
   "dt_from": "YYYY-MM-DDTHH:MM:SS",
   "dt_upto": "

YYYY-MM-DDTHH:MM:SS",
   "group_type": "hour/day/month"
}
```

Замените `dt_from`, `dt_upto` и `group_type` на желаемые параметры. Бот ответит агрегированными данными в соответствии с вашим вводом.